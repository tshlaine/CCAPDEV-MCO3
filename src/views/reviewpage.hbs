<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/public/styles/reviewpage.css">
    <script src="/script/reviewpage.js" defer></script>
    <link rel="icon" type="image/png" href="/assets/Cafe St Logo.PNG">
</head>
<body>
    {{> navbarreviewpage}}

    <div class ="review-panel">
            <div class="plus-sign" onclick="togglePopup()">+</div>
            <div class="popup-create" id="popup-create" style="display: none;">
            <div class="popup-content">
                <span class="x" onclick="togglePopup()">
                    <img src="../../images/xicon.png" class="close">
                </span>
                <p class = "experience">Tell us, how was your experience</p>
                <div class="ratings-popup">
                    <input type="radio" id="star5" name="rate" value="5">
                    <label for="star5" title="Excellent">★</label>
                
                    <input type="radio" id="star4" name="rate" value="4">
                    <label for="star4" title="Very Good">★</label>
                
                    <input type="radio" id="star3" name="rate" value="3">
                    <label for="star3" title="Fair">★</label>
                
                    <input type="radio" id="star2" name="rate" value="2">
                    <label for="star2" title="Tolerable">★</label>
                
                    <input type="radio" id="star1" name="rate" value="1">
                    <label for="star1" title="Poor">★</label>
                </div>
                <div class="categorized">
                    <button class="button1" onclick="changeColor(this)">Budget Friendly</button>
                    <button class="button2" onclick="changeColor(this)">Study Friendly</button>
                    <span class="note">*Can be left empty</span>
                </div>
                <p class = "titleyour">Title your review</p>
                <input type="text" id="review-title" class="review-title" placeholder="Enter your Title...">
                <p class = "writeyour">Write your review</p>
                <input type="text" id="review-words" class="review-words" placeholder="Enter your Review...">
                <input type="file" id="image-upload" class="image-upload" accept="image/*">
                <div class="button-container">
                    <a href="/reviewpage?name={{cafe.name}}&location={{cafe.location}}&category={{cafe.category}}&description={{cafe.description}}&averageRating={{cafe.averageRating}}&slideImages1={{cafe.slideImages1}}&slideImages2={{cafe.slideImages2}}&slideImages3={{cafe.slideImages3}}" class="search-anchor">
                        <button type="submit" class="submit">Submit</button>
                    </a>
                    
                </div>
                
            </div>

        </div>
        <span class = "namecafe">{{cafe.name}}</span>
        <a class = "loc" href="{{cafe.location_link}}"> {{cafe.location}}</a>
        <div class = "about">
            <p class = "desc">
                 {{cafe.description}}
            </p>
            <div class="category">
            {{#if cafe.category1}}
                <div class="category1">
                    <span>{{cafe.category1}}</span>
                </div>
            {{/if}}
            {{#if cafe.category2}}
                <div class="category2">
                    <span>{{cafe.category2}}</span>
                </div>
            {{else}}
               
            {{/if}}
        </div>
        <hr class = "hrabout">
        <div class="rating">{{cafe.averageRating}} <span class="outof5">out of 5</span></div>
        <div class="noofreviews">{{reviewCount}} review/s</div>
        </div>
        <div class="slideshow-container">
        
            <div class="slide">
            <img src="{{cafe.slideImages1}}" class="pics" />
            </div>
            <div class="slide">
                <img src="{{cafe.slideImages2}}" class="pics" />
            </div>
            <div class="slide">
                <img src="{{cafe.slideImages3}}" class="pics" />
            </div>
          
            
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>

            <div class="dot-container">
                <span class="dot" onclick="currentSlide(1)"></span>
                <span class="dot" onclick="currentSlide(2)"></span>
                <span class="dot" onclick="currentSlide(3)"></span>

            </div>
        </div>
        <hr class="divider">
        <p class = "reviews">Reviews</p>
        <div class="review-area">
        {{#if cafes}}
            {{#if reviews}}
                {{#each reviews}}
            <div class="review-box" >
               <button class="threedot" onclick="toggleDropdown2(this)">
                    <img src="../../images/options.png">
                </button>
    
                <div class="dropdown-content2" id="dropdownContent2_{{reviewId}}">
               <a id="openEditPopup_{{reviewId}}" onclick="toggleEditPopup('{{reviewId}}')">Edit</a>
               <a class="delete-review" data-review-id="{{reviewId}}" onclick="toggleDeletePopup()">Delete</a>
                </div>

                <!-- Delete Popup -->
               <div class="delete-popup" id="deletePopup" style="display: none;">
                <div class="popup-deletecontent">
                    <span class="x" onclick="toggleDeletePopup('{{reviewId}}')">
                        <img src="../../images/xicon.png" class="close">
                    </span>
                    <p class="deletenote">Are you sure you want to delete this review?</p>
                    <div class="button-container-delete">
                        <a href="/delete-review/{{reviewId}}" class="delete-review" data-review-id="{{reviewId}}">
                            <button>Yes</button>
                        </a>
                        <button class="no-button" onclick="toggleDeletePopup()">No</button>
                    </div>
                </div>
            </div>

               <!-- Edit Popup -->
                <div class="popup-edit" id="editPopup_{{reviewId}}" style="display: none;">
                    <div class="popup-content-edit">
                            <span class="x" onclick="toggleEditPopup('{{reviewId}}')">
                                    <img src="../../images/xicon.png" class="close">
                                </span>
                                <p class="experience">Edit Your Review</p>
                                <div class="ratings-popup">
                            <input type="radio" id="star5" name="rate" value="5">
                            <label for="star5" title="Excellent">★</label>
                        
                            <input type="radio" id="star4" name="rate" value="4">
                            <label for="star4" title="Very Good">★</label>
                        
                            <input type="radio" id="star3" name="rate" value="3">
                            <label for="star3" title="Fair">★</label>
                        
                            <input type="radio" id="star2" name="rate" value="2">
                            <label for="star2" title="Tolerable">★</label>
                        
                            <input type="radio" id="star1" name="rate" value="1">
                            <label for="star1" title="Poor">★</label>
                        </div>
                                
                        <div class="categorized">
                            <button class="button1" onclick="changeColor(this)">Budget Friendly</button>
                            <button class="button2" onclick="changeColor(this)">Study Friendly</button>
                            <span class="note">*Can be left empty</span>
                        </div>
                        <p class="titleyour">Edit your review title</p>
                        <input type="text" id="edit-review-title" class="edit-review-title" placeholder="Enter your Title...">
                        <p class="writeyour">Edit your review</p>
                        <input type="text" id="edit-review" class="edit-review-words" placeholder="Enter your Review...">
                        <input type="file" id="edit-image" class="image-upload" accept="image/*">
                        <div >
                            <!-- Change the submit button to trigger edit review -->
                            <button type="button" class="submit-edit" onclick="editReview()">Submit</button>
                        </div>
                    </div>
                </div>


                <div class="reaction">
                    <button class="helpful"><img src="../../images/thumb.png"></button>
                    <span class = "numberofreact">{{helpful}}</span>
                    <button class="unhelpful"><img src="../../images/thumbdown.png"></i></button>
                    <span class = "numberofreact">{{unhelpful}}</span>
                </div>
                <div class="profile-info">
                    <div class="profile-pic">
                        <img src="../../images/dog.jpg" alt="Profile Picture" />
                    </div>
                   
                     <div class="username"><a href="profile.html">{{userIdToUsernameMap.[index]}}</a></div>
                    
                </div>                
                <div class="review-content">             
                    <div class="ratings">
                        <input type="radio" id="star1" name="rate" value="1">
                        <label for="star1" title="text">1 star</label>
    
                        <input type="radio" id="star2" name="rate" value="2">
                        <label for="star2" title="text">2 stars</label>
    
                        <input type="radio" id="star3" name="rate" value="3">
                        <label for="star3" title="text">3 stars</label>
    
                        <input type="radio" id="star4" name="rate" value="4">
                        <label for="star4" title="text">4 stars</label>
    
                        <input type="radio" id="star5" name="rate" value="5">
                        <label for="star5" title="text">5 stars</label>
                    </div>
                    <div class="title">
                        {{reviewtitle}}
                    </div>
                    <div class="paragraph">
                        {{reviewbody}}
                    </div>
                    <div class="category-review">
                    {{#if category1review}}
                        <div class="category1review">
                            <span>{{category1review}}</span>
                        </div>
                    {{/if}}
                    {{#if category2review}}
                        <div class="category2review">
                            <span>{{category2review}}</span>
                        </div>
                    {{else}}
                    
                    {{/if}}
                </div>
                <div class="images-container">
                    {{#if media}}
                        <img class="image" src="{{media}}">
                    {{/if}}
                </div>
                    <div class = "date">
                        {{dateandtime}}
                    </div>
                </div>
            </div>
            <hr class = "div">
            {{/each}}
          
    {{else}}
        <span class="message">No Reviews to Display</span>
    {{/if}}
{{else}}
    <span class="message">No Cafes to Display</span>
{{/if}}
            
    </div>
</body>
</html>